{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImage(value, currentPage) {\n  const KEY = '43131221-437eb08730a4aa4be76ca14ef';\n  const url = 'https://pixabay.com/api/';\n\n  const params = {\n    key: KEY,\n    q: value,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    page: currentPage,\n    per_page: 15,\n    safesearch: true,\n  };\n\n  const res = await axios.get(url, { params });\n  return res.data;\n}\n","function imageTemplate(data) {\n  const {\n    largeImageURL,\n    webformatURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = data;\n  return `<li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t<img    \n            loading=\"lazy\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n            width=\"360\"\n            height=\"200\"\n            class=\"gallery-img\"\n        />\n        <ul class=\"gallery-descript\">\n        <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">likes</span> ${likes}</li>\n        <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">Views</span> ${views}</li>\n        <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">Coments</span> ${comments}</li>\n        <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">Dowloads</span> ${downloads}</li>\n     </ul>\n\t</a>\n</li>`;\n}\n\nexport function imagesTemplate(arr) {\n  return arr.map(imageTemplate).join('');\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\n\nimport { getImage } from './js/pixabay-api';\nimport { imagesTemplate } from './js/render-functions';\n//=========================================================================\nconst refs = {\n  formEl: document.querySelector('.form'),\n  listEL: document.querySelector('.gallery'),\n  loaderEl: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('[data-action=load-more]'),\n};\n//===========================================================================\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n//===========================================================================\n\nlet currentPage = 1;\nlet maxPage = 0;\nlet value;\nconst pageSize = 15;\n\n//===========================================================================\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', onLoadMoreClick);\n\n//===========================================================================\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n  refs.listEL.innerHTML = '';\n  currentPage = 1;\n  value = event.target.elements.value.value.trim();\n\n  if (!value) {\n    iziToast.error({\n      title: 'Error',\n      message: 'The search field is empty. Please try again!',\n    });\n  }\n\n  try {\n    showLoader();\n    const data = await getImage(value, currentPage);\n    maxPage = Math.ceil(data.totalHits / pageSize);\n    if (!data.hits.length) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n    const markup = imagesTemplate(data.hits);\n    refs.listEL.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n  }\n  hideLoader();\n  checkBtnStatus();\n  refs.formEl.reset();\n}\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  showLoader();\n  try {\n    const data = await getImage(value, currentPage);\n    const markup = imagesTemplate(data.hits);\n    refs.listEL.insertAdjacentHTML('beforeend', markup);\n  } catch (err) {\n    console.log(err);\n  }\n\n  myScroll();\n  hideLoader();\n  checkBtnStatus();\n}\n//=========================================================================\nfunction showLoader() {\n  refs.loaderEl.classList.remove('is-hidden');\n}\nfunction hideLoader() {\n  refs.loaderEl.classList.add('is-hidden');\n}\nfunction showLoadMoreBtn() {\n  refs.loadMoreBtn.classList.remove('is-hidden');\n}\nfunction hideLoadMoreBtn() {\n  refs.loadMoreBtn.classList.add('is-hidden');\n}\nfunction checkBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadMoreBtn();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    showLoadMoreBtn();\n  }\n}\nfunction myScroll() {\n  const height = refs.listEL.firstChild.getBoundingClientRect().height;\n\n  scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["getImage","value","currentPage","KEY","url","params","axios","imageTemplate","data","largeImageURL","webformatURL","tags","likes","views","comments","downloads","imagesTemplate","arr","refs","lightbox","SimpleLightbox","maxPage","pageSize","onFormSubmit","onLoadMoreClick","event","iziToast","showLoader","markup","error","hideLoader","checkBtnStatus","err","myScroll","showLoadMoreBtn","hideLoadMoreBtn","height"],"mappings":"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"}